%====基于Jerk的多涡卷混沌系统======
%dx/dt=y;
%dy/dt=z;
%dz/dt=-a*x-b*y-c*z+f(x)
function dy=Jerk_Multiscroll(t,y)
dy=zeros(3,1);

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
global a;
global b;
global c;
global d;
global n ; %n为涡卷的个数

shitf=n/(2*b);

% % %===============case 2 c=0.3,d=0.5,b=0.5不变，改变a=====================
% % a=0.5;%效果好
% % a=0.7;%效果好
% % a=0.8;%单周期
% % a=1;%单周期
% a=1;%y(2)的系数
% c=0.3;%y(3)的系数
% b=0.5;%正弦函数的系数
%  %d=0.2    %效果好
% % d=0.5  %效果好
% d=0.5;%f(x)的系数  ,
% % %===============case 2==================================================
% % %===============case 3 a=1,d=0.5,b=0.5不变，改变c=====================

% a=1;%y(2)的系数
% b=0.5;%正弦函数的系数
% d=0.5;%f(x)的系数  ,
% % c=0.3;% %效果好
% % c=0.2;% %效果好
% % c=0.1;% %,更稠密，但能观察到涡卷轮廓，效果好
% %  c=0.4;%拟周期
% %   c=0.5;%周期=2
% %  c=0.6;%周期=1
%   c=0.7;%周期=1
% % %===============case 3==================================================
%%上面是参数设置，下面是对应的方程 

% shitf =6;
fx=-sin(2*pi*b*y(1)).*[sign(y(1)+shitf)-sign(y(1)-shitf)-1];%正确 
fy=0;%单涡卷 
dy(1)=10*[y(2)];
dy(2)=10*y(3);
dy(3)=10*[-a*[y(2)]-c*y(3)-d*fx];%p=q=0,k=10的双涡卷

% % % --------------------------1-D涡卷 结束  -------------------------
% % --------------------------2-D涡卷 开始 --------------------------
% a=1;%y(2)的系数
% b=0.5;%正弦函数的系数
% d=0.5;%f(x)的系数  ,
% c=0.2;% %效果好
% 
% shitf=6;
% % fy=0;
% fy = 1*sign(y(2));
% fx=-sin(2*pi*b*y(1)).*[sign(y(1)+shitf)-sign(y(1)-shitf)-1];%正确 
% dy(1)=10*[y(2)-fy];
% dy(2)=10*y(3);
% dy(3)=10*[-a*[y(2)-fy]-c*y(3)-d*fx];%p=q=0,k=10的双涡卷
% % --------------------------2-D涡卷 结束
% -----------------------------------------------------------------

% % --------------------------3-D涡卷 开始 --------------------------
% a=1.15;%y(2)的系数
% b=0.5;%正弦函数的系数
% d=0.55;%f(x)的系数  ,
% c=0.3;% 
% 
% shitf=6;
% 
% % % //=====y-z方向各2个涡卷============
% % fy = 1*sign(y(2));%2个涡卷
% % fz = 1*sign(y(3));%2个涡卷
% % % //=====y-z方向各2个涡卷<<<============
% 
% % % //=====y-z方向各4个涡卷============
% % fy = 1*[sign(y(2))+sign(y(2)+2)+sign(y(2)-2)];%4个涡卷
% % fz = 1*[sign(y(3))+sign(y(3)+2)+sign(y(3)-2)];%4个涡卷
% % % //=====y-z方向各4个涡卷<<<============
% 
% 
% fy = 1*[sign(y(2)+1)+sign(y(2)-1)];%3个涡卷
% fz = 1*[sign(y(3)+1)+sign(y(3)-1)];%3个涡卷
% fx=-sin(2*pi*b*y(1)).*[sign(y(1)+shitf)-sign(y(1)-shitf)-1];%正确 
% dy(1)=10*[y(2)-fy];
% dy(2)=10*[y(3)-fz];
% dy(3)=10*[-a*[y(2)-fy]-c*[y(3)-fz]-d*fx];%p=q=0,k=10的双涡卷
% % --------------------------3-D涡卷 结束
% -----------------------------------------------------------------

% % -------------------------饱和函数双涡卷 开始 -----------------------------------------
% dy(1)=40*[(2*k/h1)*y(2)-yy2];
% dy(2)=40*y(3);
% dy(3)=40*[-a*y(1)-a*y(2)-c*y(3)+d*yy+d*yy2];%p=q=0,k=10的双涡卷
% % -------------------------饱和函数双涡卷 结束-----------------------------------------
% -------------------------饱和函数3涡卷 开始 -----------------------------------------
% dy(1)=100*[(2*k/h1)*y(2)-yy2];
% dy(2)=100*[(2*k/h1)*y(3)-yy3];
% dy(3)=100*[-a*y(1)-a*y(2)-a*y(3)+d*yy+d*yy2+d*yy3];%p=q=0,k=10的双涡卷
% -------------------------饱和函数3涡卷  结束-----------------------------------------

end