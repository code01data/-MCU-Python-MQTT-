
# 主成分分析
本文将介绍主成分分析(PCA)，主成分分析是一种降维算法，它能将多个指标转换为少数几个主成分，这些主成分是原始变量的线性组合，且彼此之间互不相关，其能反映出原始数据的大部分信息。 一般来说，当研究的问题涉及到多变量且变量之间存在很强的相关性时，我们可考虑使用主成分分析的方法来对数据进行简化。

## 一、主成分分析简介
主成分分析是一种数学降维的方法，找出几个综合变量来代替原来众多的变量，使这些综合变量能尽可能地代表原来变量的信息量，而且彼此之间互不相关。这种将把多个变量化为少数几个互相无关的综合变量的统计分析方法就叫做主成分分析。
## 二、主成分分析的思想
#### 数学降维
![主成分分析1.png](https://img1.imgtp.com/2022/08/23/28xCZffG.png)
## 三、主成分分析的计算步骤
1. 对原始数据进行标准化处理
2. 计算标准化样本的协方差矩阵R
3. 计算R的特征值和特征向量
4. ·计算主成分贡献率以及累计贡献率
5. 写出主成分表达式
6. 根据系数分析主成分代表的意义（很重要，就是解释主成分变量的意义和作用）
7. 利用主成分的结果进行后续的分析
![主成分分析2.png](https://img1.imgtp.com/2022/08/23/Gh5Zp7xR.png)
![主成分分析3.png](https://img1.imgtp.com/2022/08/23/vISuAklQ.png)
![主成分分析4.png](https://img1.imgtp.com/2022/08/23/cbrvtrLZ.png)
![主成分分析5.png](https://img1.imgtp.com/2022/08/23/Vegv9wZm.png)
![主成分分析6.png](https://img1.imgtp.com/2022/08/23/KDRqxPOd.png)
## 四、案例分析
通过excel或者提供的数据进行导入，建立矩阵x，然后标准化矩阵X,接下来的实验都是对标准化矩阵进行的操作。
```matlab
 R = corrcoef(x);% 计算样本相关系数矩阵R 
 ```
![案例2.png](https://img1.imgtp.com/2022/08/23/tyk5MEyr.png)
![案例：.png](https://img1.imgtp.com/2022/08/23/p7Ls8Gem.png)
#####  code
![主成分分析code.png](https://img1.imgtp.com/2022/08/23/wFD8D2p6.png)
```matlab
clear;clc
 load data1.mat   % 主成分聚类
%  load data2.mat   % 主成分回归

% 注意，这里可以对数据先进行描述性统计
% 描述性统计的内容见第5讲.相关系数
[n,p] = size(x);  % n是样本个数，p是指标个数

%% 第一步：对数据x标准化为X
X=zscore(x);   % matlab内置的标准化函数（x-mean(x)）/std(x)

%% 第二步：计算样本协方差矩阵
R = cov(X);

%% 注意：以上两步可合并为下面一步：直接计算样本相关系数矩阵
R = corrcoef(x);
disp('样本相关系数矩阵为：')
disp(R)

%% 第三步：计算R的特征值和特征向量
% 注意：R是半正定矩阵，所以其特征值不为负数
% R同时是对称矩阵，Matlab计算对称矩阵时，会将特征值按照从小到大排列哦
% eig函数 特征值，特征向量
[V,D] = eig(R);  % V 特征向量矩阵  D 特征值构成的对角矩阵


%% 第四步：计算主成分贡献率和累计贡献率
lambda = diag(D);  % diag函数用于得到一个矩阵的主对角线元素值(返回的是列向量)
lambda = lambda(end:-1:1);  % 因为lambda向量是从小大到排序的，我们将其调个头
contribution_rate = lambda / sum(lambda);  % 计算贡献率
cum_contribution_rate = cumsum(lambda)/ sum(lambda);   % 计算累计贡献率  cumsum是求累加值的函数
disp('特征值为：')
disp(lambda')  % 转置为行向量，方便展示
disp('贡献率为：')
disp(contribution_rate')
disp('累计贡献率为：')
disp(cum_contribution_rate')
disp('与特征值对应的特征向量矩阵为：')
% 注意：这里的特征向量要和特征值一一对应，之前特征值相当于颠倒过来了，因此特征向量的各列需要颠倒过来
%  rot90函数可以使一个矩阵逆时针旋转90度，然后再转置，就可以实现将矩阵的列颠倒的效果
V=rot90(V)';
disp(V)


%% 计算我们所需要的主成分的值
m =input('请输入需要保存的主成分的个数:  ');
F = zeros(n,m);  %初始化保存主成分的矩阵（每一列是一个主成分）
for i = 1:m
    ai = V(:,i)';   % 将第i个特征向量取出，并转置为行向量
    Ai = repmat(ai,n,1);   % 将这个行向量重复n次，构成一个n*p的矩阵
    F(:, i) = sum(Ai .* X, 2);  % 注意，对标准化的数据求了权重后要计算每一行的和
end
```
